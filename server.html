<!doctype html>
<div class="container">
<div class="panel left">
<h3>Menu</h3>
<div id="menuList"></div>
</div>
<div class="panel right">
<h3>Create Order</h3>
<label>Table Number: <input id="tableNumber" type="number" min="1" /></label>
<div style="margin-top:8px;">
<div id="currentOrderArea">
<ul id="orderItems"></ul>
</div>
<div style="margin-top:10px;">
<label>Note: <input id="orderNote" placeholder="e.g., allergy info" /></label>
</div>
<div style="margin-top:12px;">
<button id="submitOrder">Submit to Kitchen</button>
</div>
<div id="msg" style="margin-top:12px;color:green"></div>
</div>
</div>
</div>


<script>
function $(id){ return document.getElementById(id); }


// current user
const user = JSON.parse(localStorage.getItem('currentUser') || 'null');
if(!user || user.role !== 'server'){ alert('Please sign in as Server'); window.location='index.html'; }
$('serverInfo').innerText = `Logged in as: ${user.name} (Role: ${user.role})`;


// initialize MENU in localStorage if not present
if(!localStorage.getItem('MENU')){
const defaultMenu = [
{ id:'m1', name:'Caesar Salad', price:8.50, modifiers:['No Dressing','Extra Dressing'] },
{ id:'m2', name:'Cheeseburger', price:11.00, modifiers:['Well-Done','No Onions','Add Bacon'] },
{ id:'m3', name:'Margherita Pizza', price:12.50, modifiers:['Extra Cheese','No Basil','Gluten-Free'] },
{ id:'m4', name:'Fries', price:4.0, modifiers:['No Salt','Extra Crispy'] }
];
localStorage.setItem('MENU', JSON.stringify(defaultMenu));
}


// unified menu storage helper
function getMenu() { return JSON.parse(localStorage.getItem('MENU') || '[]'); }
function saveMenu(m){ localStorage.setItem('MENU', JSON.stringify(m)); }


// small local UI state
const state = { orderItems: [] };


// render menu list
function renderMenu(){
const container = $('menuList');
container.innerHTML = '';
getMenu().forEach(it=>{
const div = document.createElement('div');
div.className='menu-item';
const left = document.createElement('div');
left.innerHTML = `<strong>${it.name}</strong><div class="small">$${it.price.toFixed(2)}</div>`;
const right = document.createElement('div');
const addBtn = document.createElement('button');
addBtn.innerText='Add';
addBtn.onclick = ()=> addItem(it);
right.appendChild(addBtn);
div.appendChild(left);
div.appendChild(right);
container.appendChild(div);
});
}


// render order
function renderOrder(){
const ul = $('orderItems');
ul.innerHTML='';
state.orderItems.forEach((it, idx)=>{
const li = document.createElement('li'); li.className='ticket-item';
const left = document.createElement('div');
left.innerHTML = `<strong>${it.qty} Ã— ${it.name}</strong><div class="modifier">${(it.modifiers||[]).join(', ')}</div>`;
const right = document.
