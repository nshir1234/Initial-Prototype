<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<title>Edit Menu Item</title>
<meta name="viewport" content="width=device-width,initial-scale=1" />
<style>
body { font-family: Arial, padding:14px; background:#fff; }
header { display:flex; justify-content:space-between; align-items:center; margin-bottom:12px; }
.card { background:#fafafa; border-radius:8px; padding:12px; box-shadow:0 1px 6px rgba(0,0,0,0.06); }
input { padding:6px; margin:4px 0; width:100%; box-sizing:border-box; }
button { padding:8px 10px; border-radius:6px; cursor:pointer; margin-right:6px; }
.small { font-size:0.9em; color:#666; }
</style>
</head>
<body>
<header>
  <div><h2>Edit Menu Item</h2><div class="small" id="managerInfo"></div></div>
  <div>
    <button id="back">Back</button>
    <button id="logout">Logout</button>
  </div>
</header>

<div class="card" id="editArea">Loading...</div>

<script>
function $(id){ return document.getElementById(id); }

const user = JSON.parse(localStorage.getItem('currentUser') || 'null');
if(!user || user.role!=='manager'){ alert('Sign in as Manager'); window.location='index.html'; }
$('managerInfo').innerText = `Logged in as: ${user.name} (Role: ${user.role})`;

const params = new URLSearchParams(window.location.search);
const id = params.get('id');

function getMenu(){ return JSON.parse(localStorage.getItem('MENU')||'[]'); }
function saveMenu(menu){ localStorage.setItem('MENU', JSON.stringify(menu)); }

function render(){
  const menu = getMenu();
  const item = menu.find(i=>i.id===id);
  if(!item){ $('editArea').innerHTML='<div class="small">Item not found.</div>'; return; }

  $('editArea').innerHTML=`
    <label>Name:<input id="name" value="${item.name}"></label>
    <label>Price:<input id="price" type="number" step="0.01" value="${item.price}"></label>
    <label>Modifiers (comma separated):<input id="modifiers" value="${item.modifiers.join(', ')}"></label>
    <div style="margin-top:12px;">
      <button id="saveBtn">Save</button>
    </div>
  `;

  $('saveBtn').onclick=()=>{
    item.name=$('name').value.trim()||item.name;
    item.price=parseFloat($('price').value)||item.price;
    item.modifiers=$('modifiers').value.split(',').map(s=>s.trim()).filter(Boolean);
    saveMenu(menu);
    alert('Menu item saved!');
  };
}

$('back').addEventListener('click', ()=> window.location='menu.html');
$('logout').addEventListener('click', ()=> { localStorage.removeItem('currentUser'); window.location='index.html'; });

render();
</script>
</body>
</html>
